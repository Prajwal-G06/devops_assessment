# DevOps Assessment ‚Äì Setup Guide

> This project implements a complete end-to-end DevOps workflow where infrastructure is provisioned using Terraform, applications are containerized using Docker, and a GitHub Actions CI/CD pipeline automatically builds, pushes, and deploys the application to AWS EC2.

---

## 1. What This Repository Contains

This repository implements a full DevOps workflow for a full-stack Hello World application.

### Frontend
- React frontend built with Vite  
- Dockerfile for containerization  

### Backend
- Django REST API  
- Dockerfile for containerization  

### Orchestration
- `docker-compose.yml` for production / deployment  
- `docker-compose.dev.yml` for local development multi-container setup  

### Infrastructure as Code
- `terraform/` contains IaC to provision AWS infrastructure  

### CI/CD
- GitHub Actions workflow in `.github/workflows/ci-cd.yml`  
  Automates build, push, and deployment  

### Other
- README and DEVOPS.md for documentation  

---

## 2. Running the Application Locally

### Prerequisites
- Git  
- Docker & Docker Compose  

### Steps

1. Clone the repository:

    ```bash
    git clone https://github.com/Prajwal-G06/devops_assessment
    ```

    ```bash
    cd devops_assessment
    ```

    ```bash
    docker compose -f docker-compose.dev.yml up -d --build
    ```

    ```bash
    docker compose -f docker-compose.dev.yml down
    ```

Test it with your local url.

---

## 3. Provisioning AWS Infrastructure Using Terraform

Terraform is used to provision and configure the complete AWS infrastructure required to run the application.

### What Terraform Provisions

- RSA key pair (automatically generated)
- AWS EC2 instance
- Security group with required ports (22, 80, 443, 8000)
- Automatic installation of Docker and Docker Compose using `user_data`

All Terraform code is located inside the `terraform/` directory.

### Prerequisites

Before running Terraform, ensure:

- Terraform is installed
- AWS credentials are configured locally:

    ```bash
    aws configure
    
### Steps to Provision Infrastructure

Follow these steps to create the AWS infrastructure using Terraform:

1. Navigate to the Terraform directory:

    ```bash
    cd terraform

2. Initialize Terraform

    ```bash
    terraform init

3. Review the execution plan

    ```bash
    terraform plan -var-file="example.tfvars"

4. Provision the infrastructure

    ```bash
    terraform apply -var-file="example.tfvars"

Type yes when prompted.

# After successful execution, Terraform will:

1. Generate an RSA key pair
2. Create a security group
3. Launch an EC2 instance
4. Install Docker and Docker Compose automatically

# Important Note After EC2 Creation

1. After the EC2 instance is created, wait 2‚Äì5 minutes before connecting.
This allows the user_data script to finish installing Docker and adding the default user to the Docker group.
2. When you connect to the instance for the first time, Docker may not work immediately for the normal user.
3. If you face permission issues like:
    ```bash
    permission denied while trying to connect to the Docker daemon socket
‚û°Ô∏è Simply disconnect and reconnect to the EC2 instance one or two times.
Docker will then work normally without sudo.

## Connect to the EC2 instance.
### Create a project directory:
```bash
mkdir app && cd app
```

Create or upload the docker-compose.yml file from the project repository into this directory.

---

## 4. Configure GitHub Secrets (Required for CI/CD)

After the infrastructure is provisioned and the EC2 instance is running, the following secrets must be added to the GitHub repository for the CI/CD pipeline to work.

Navigate to:

**GitHub Repository ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí New repository secret**

Add the following secrets:

| Secret Name        | Description |
|--------------------|-------------|
| `DOCKER_USERNAME` | Docker Hub username |
| `DOCKER_PASSWORD` | Docker Hub password or access token |
| `EC2_HOST`        | Public IP address of the EC2 instance |
| `EC2_USER`        | SSH username (ubuntu) |
| `EC2_SSH_KEY`     | Private SSH key generated by Terraform (`devops-assignment.pem`, "you will find it in the terraform folder) |
| `EC2_PATH`        | Application directory on EC2 (`/home/ubuntu/app`) |

These secrets are used by the GitHub Actions workflow to:

- Authenticate to Docker Hub  
- Connect securely to the EC2 instance  
- Deploy containers automatically using Docker Compose  

No sensitive information is committed to the repository.

---

## 5. CI/CD Deployment Flow

Once the infrastructure is provisioned and all GitHub secrets are configured, the CI/CD pipeline becomes fully functional.

On every push to the `master` branch, GitHub Actions automatically performs the following steps:

1. Checks out the source code  
2. Logs in to Docker Hub using stored secrets  
3. Builds the backend Docker image  
4. Builds the frontend Docker image  
5. Pushes both images to Docker Hub  
6. Connects to the EC2 instance via SSH  
7. Navigates to the application directory  
8. Pulls the latest Docker images  
9. Recreates the containers using Docker Compose  

As a result, every code change is automatically built and deployed to the EC2 server without any manual intervention.

This ensures a complete Continuous Integration and Continuous Deployment (CI/CD) workflow.

#### Troubleshooting steps will be found in the [DevOps.md](DevOps.md), Please refer there.

## üåç Access the app here
[Visit the live site here](http://ec2-13-232-190-194.ap-south-1.compute.amazonaws.com/)


